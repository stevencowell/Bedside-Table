<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="description" content="Stage 5 Industrial Technology Timber - Bedside Table Project - 2025" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bedside Table Project</title>
  <style>
    /* General Styles */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f4f4f4;
    }
    a {
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }
    h1, h2, h3, h4, h5 {
      margin: 0 0 10px 0;
    }
    /* HEADER SECTION STYLES */
    header {
      background: #007bff;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      font-size: 2.5em;
    }
    header p {
      font-size: 1.2em;
    }
    /* NAVIGATION STYLES */
    nav {
      display: flex;
      justify-content: center;
      background: #0056b3;
      flex-wrap: wrap;
    }
    nav a {
      padding: 15px 20px;
      color: #fff;
      display: inline-block;
      transition: background 0.3s;
    }
    nav a:hover, nav a.active {
      background: #003f80;
    }
    /* GOOGLE CLASSROOM SECTION STYLES */
    .google-classroom {
      background: #fffbcc;
      padding: 20px;
      text-align: center;
      border: 1px solid #e0e0e0;
      margin: 20px auto;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      border-radius: 5px;
    }
    .google-classroom h2 {
      color: #007bff;
    }
    .google-classroom p {
      font-size: 1.1em;
    }
    .google-classroom a {
      display: inline-block;
      background: #007bff;
      color: #fff;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 5px;
      font-weight: bold;
      transition: background 0.3s;
    }
    .google-classroom a:hover {
      background: #0056b3;
    }
    /* NEW: Google Image Styles */
    .google-image {
      text-align: center;
      margin: 20px 0;
    }
    .google-image img {
      max-width: 400px;
      width: 100%;
      height: auto;
      border-radius: 5px;
    }
    /* MAIN CONTENT STYLES */
    main.content {
      padding: 20px;
    }
    .content-section {
      display: none; /* Hidden by default; activated via JS */
      background: #fff;
      margin: 10px auto;
      padding: 20px;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 5px;
    }
    .content-section.active {
      display: block;
    }
    .content-section h2 {
      color: #007bff;
      margin-bottom: 15px;
      border-bottom: 2px solid #f4f4f4;
      padding-bottom: 5px;
    }
    .content-section h3 {
      margin-top: 20px;
      color: #333;
    }
    .content-section h4 {
      margin-top: 15px;
      color: #555;
    }
    .content-section p, .content-section li {
      margin-bottom: 10px;
    }
    .content-section ul, .content-section ol {
      margin: 10px 0 15px 20px;
    }
    .content-section details {
      background: #e9ecef;
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
    }
    .content-section summary {
      cursor: pointer;
      font-size: 1.05em;
    }
    .content-section summary::-webkit-details-marker {
      color: #007bff;
    }
    .content-section details p {
      margin: 5px 0;
    }
    .resource-links ul {
      list-style: none;
      padding: 0;
    }
    .resource-links li {
      margin: 5px 0;
    }
    .resource-links a {
      color: blue;
    }
    /* Styles for quiz feedback */
    .quiz label[data-result="right"] {
        color: green;
        font-weight: bold;
    }
    .quiz label[data-result="wrong"] {
        color: red;
        text-decoration: line-through;
    }
    .quiz-msg {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    /* Style for audio buttons */
    .quiz button[aria-label^="Read"] {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1em;
        padding: 0 5px;
        vertical-align: middle;
    }

    /* Ensure all list texts are bold (except quiz lists) */
    .content-section ul li,
    .content-section ol li,
    .resource-links ul li {
      font-weight: bold;
    }
    /* Keep quiz list items normal weight */
    .quiz li {
      font-weight: normal;
    }
    .resource-links a {
      font-weight: bold;
    }



/* Ensure all summary headings (list links) are bold */
summary { font-weight: bold; }

  

  /* Make all textareas taller & wider */
  textarea { min-height: 140px; width: 95%; max-width: 900px; }
  .wide-textarea { width: 98%; max-width: 1000px; }

    /* Popup box styles */
    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .popup-overlay.active {
      display: flex;
    }
    .popup-box {
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      position: relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    .popup-box a {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border-radius: 4px;
      font-weight: bold;
    }
    .popup-box button:not(.close-popup) {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
    }
    .popup-box button:not(.close-popup):hover {
      background: #0056b3;
    }
    .popup-box button.close-popup {
      background: none;
      border: none;
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2em;
      cursor: pointer;
    }

</style>

</head>
<body>
<header>
  <h1><b>Stage 5 Industrial Technology Timber - Bedside Table Project</b> - 2025</h1>
  <p>Resources, Projects, and Content for Learning</p>
  <div class="header-image">
    <!-- STAFF: Replace 'sample_project.png' with your project image -->
      <img src="table.png" alt="Bedside Table" style="max-width:300px; width:100%; margin-top:20px; border-radius:5px;" />
    <div class="plan-link" style="margin-top:10px;">
      <!-- STAFF: Update link to your project's plan PDF -->
      <a href="BedsideTablePlan.pdf" style="background:#28a745; color:#fff; padding:10px 15px; border-radius:4px; font-weight:bold; display:inline-block;" target="_blank">Download Project Plan (PDF)</a>
    </div>
  </div>
</header>

<section class="google-classroom" aria-label="Google Classroom Invitation">
  <h2>Join Our Google Classroom</h2>
  <p>Use the code below to join the class and access all online resources:</p>
  <p><strong>Classroom Code: <span style="color:#d9534f; font-size:1.3em;">bedside23</span></strong></p>
  <!-- STAFF: Update the Google Classroom link -->
  <a href="https://classroom.google.com/w/NzQ5MDQxMzk4MjAz/t/all" target="_blank">Join Google Classroom</a>
</section>

<nav aria-label="Main Navigation">
  <a class="nav-link active" data-section="program" href="#program">Subject Program</a>
  <a class="nav-link" data-section="syllabus" href="#syllabus">Syllabus</a>
  <a class="nav-link" data-section="assessment" href="#assessment">Assessments</a>
  <a class="nav-link" data-section="project-unit" href="#project-unit">Bedside Table Project Unit</a>
  <a class="nav-link" data-section="main-theory" href="#main-theory">Main Theory Content</a>
  <a class="nav-link" data-section="support-activities" href="#support-activities">Support Theory Content (Optional)</a>
  <a class="nav-link" data-section="advanced-activities" href="#advanced-activities">Advanced Theory Content (Optional)</a>
</nav>

<main class="content">

<main class="content">
<details>
        <summary><strong>Week 9:</strong> Adding Design Features and Orthogonal Drawings</summary>
        <article>
          <h4>Theory Content</h4>
          <p>In Week 9, your focus shifts towards enhancing the aesthetics and functionality of your bedside table through design features. You will also refine your skills in producing accurate and detailed orthogonal drawings using Computer-Aided Design (CAD).</p>
          <h4>Adding Design Features</h4>
          <p>Incorporating distinctive design features can significantly enhance the appearance and utility of your furniture. Consider:</p>
          <ul>
            <li>Decorative mouldings or routed edges</li>
            <li>Inlays or veneers</li>
            <li>Secret drawers or hidden compartments</li>
            <li>Practical hardware such as hinges, handles, and drawer runners</li>
          </ul>
          <p>Always ensure these features complement the overall design and function of your bedside table.</p>
          <h4>Orthogonal Drawings with CAD</h4>
          <p>Creating accurate orthogonal drawings in CAD software helps visualise your project clearly, allowing for precise measurements and efficient material usage.</p>
          <ul>
            <li><b>Accuracy</b>: Ensure all measurements are exact and clearly labelled.</li>
            <li><b>Clarity</b>: Include all essential views (front, top, side).</li>
            <li><b>Detail</b>: Clearly depict design features, joints, and hardware placements.</li>
          </ul>
          <h4>Practical Activity</h4>
          <ul>
            <li>Identify suitable design features and hardware for your bedside table.</li>
            <li>Develop comprehensive orthogonal drawings using CAD software, detailing chosen design features.</li>
          </ul>
          <h4>Resources</h4>
          <div class="resource-links">
            <ul>
              <li><a href="https://www.youtube.com/watch?v=QkB8W_cK0Ic" target="_blank">CAD Orthogonal Drawing Tutorial (YouTube)</a></li>
              <li><a href="https://www.architecturaldigest.com/story/furniture-design-ideas" target="_blank">Creative Furniture Design Ideas</a></li>
            </ul>
          </div>
          <form class="quiz" data-week="9" id="week9-quiz" style="margin-top: 1.5rem;">
            <fieldset>
              <legend><strong>Have you been paying attention? – Week 9 Quiz</strong></legend>
              <ol>
                <li>
                  <p>Why is it important to add design features that complement the overall furniture design? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q1_9" type="radio" value="Cost"/> It increases the cost of the project <button aria-label="Read answer It increases the cost of the project" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q1_9" type="radio" value="Simplify"/> It simplifies construction <button aria-label="Read answer It simplifies construction" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q1_9" type="radio" value="Enhance"/> It enhances aesthetic appeal and functional utility <button aria-label="Read answer It enhances aesthetic appeal and functional utility" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q1_9" type="radio" value="Drawing"/> It makes drawing easier <button aria-label="Read answer It makes drawing easier" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>When creating orthogonal drawings in CAD, why must measurements be exact and clearly labelled? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q2_9" type="radio" value="Impress"/> To impress your teacher <button aria-label="Read answer To impress your teacher" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q2_9" type="radio" value="Quick"/> To quickly complete the drawing <button aria-label="Read answer To quickly complete the drawing" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q2_9" type="radio" value="Precise"/> To ensure precise construction and accurate assembly <button aria-label="Read answer To ensure precise construction and accurate assembly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q2_9" type="radio" value="Tools"/> To reduce the need for measurement tools <button aria-label="Read answer To reduce the need for measurement tools" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>What practical hardware could significantly enhance drawer functionality? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q3_9" type="radio" value="Paint"/> Decorative paint <button aria-label="Read answer Decorative paint" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q3_9" type="radio" value="Edges"/> Routed edges <button aria-label="Read answer Routed edges" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q3_9" type="radio" value="Runners"/> Drawer runners <button aria-label="Read answer Drawer runners" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q3_9" type="radio" value="Veneer"/> Veneer inlays <button aria-label="Read answer Veneer inlays" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Which CAD view would best illustrate the placement of drawer handles clearly? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q4_9" type="radio" value="Top"/> Top view <button aria-label="Read answer Top view" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q4_9" type="radio" value="Front"/> Front view <button aria-label="Read answer Front view" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q4_9" type="radio" value="Side"/> Side view <button aria-label="Read answer Side view" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q4_9" type="radio" value="Bottom"/> Bottom view <button aria-label="Read answer Bottom view" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Why is clarity essential in orthogonal drawings? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q5_9" type="radio" value="Interpret"/> It ensures the drawings can be accurately interpreted during construction <button aria-label="Read answer It ensures the drawings can be accurately interpreted during construction" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_9" type="radio" value="Quick"/> It helps finish the drawings quickly <button aria-label="Read answer It helps finish the drawings quickly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_9" type="radio" value="Fewer views"/> It reduces the number of views needed <button aria-label="Read answer It reduces the number of views needed" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_9" type="radio" value="Aesthetic"/> It increases the aesthetic value of the drawings <button aria-label="Read answer It increases the aesthetic value of the drawings" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>When considering decorative mouldings, what factor is most crucial? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q6_9" type="radio" value="Align"/> They must align aesthetically and structurally with the furniture <button aria-label="Read answer They must align aesthetically and structurally with the furniture" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q6_9" type="radio" value="Cheap"/> They must be inexpensive <button aria-label="Read answer They must be inexpensive" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q6_9" type="radio" value="Hard"/> They should be difficult to replicate <button aria-label="Read answer They should be difficult to replicate" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q6_9" type="radio" value="Special"/> They must require special tools <button aria-label="Read answer They must require special tools" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>What is the main advantage of including secret compartments in furniture design? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q7_9" type="radio" value="Complicate"/> To complicate the construction <button aria-label="Read answer To complicate the construction" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q7_9" type="radio" value="Function"/> To add functionality and uniqueness <button aria-label="Read answer To add functionality and uniqueness" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q7_9" type="radio" value="Heavier"/> To ensure furniture is heavier <button aria-label="Read answer To ensure furniture is heavier" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q7_9" type="radio" value="Impress"/> To impress workshop visitors <button aria-label="Read answer To impress workshop visitors" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>How does using veneers or inlays influence furniture design? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q8_9" type="radio" value="Enhance"/> They provide aesthetic enhancement without significantly affecting structural integrity <button aria-label="Read answer They provide aesthetic enhancement without significantly affecting structural integrity" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q8_9" type="radio" value="Weight"/> They dramatically increase project weight <button aria-label="Read answer They dramatically increase project weight" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q8_9" type="radio" value="No drawing"/> They make orthogonal drawings unnecessary <button aria-label="Read answer They make orthogonal drawings unnecessary" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q8_9" type="radio" value="Complicate"/> They complicate the CAD drawing significantly <button aria-label="Read answer They complicate the CAD drawing significantly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>In orthogonal drawings, why is it necessary to depict hardware placements accurately? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q9_9" type="radio" value="Regulations"/> To comply with workshop regulations <button aria-label="Read answer To comply with workshop regulations" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q9_9" type="radio" value="Guide"/> To guide precise installation and avoid construction errors <button aria-label="Read answer To guide precise installation and avoid construction errors" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q9_9" type="radio" value="Space"/> To fill drawing space <button aria-label="Read answer To fill drawing space" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q9_9" type="radio" value="Appearance"/> To enhance drawing appearance <button aria-label="Read answer To enhance drawing appearance" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>What might happen if orthogonal drawings are inaccurately produced? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q10_9" type="radio" value="Errors"/> Potential errors in assembly and increased material wastage <button aria-label="Read answer Potential errors in assembly and increased material wastage" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_9" type="radio" value="Easier"/> Easier assembly <button aria-label="Read answer Easier assembly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_9" type="radio" value="Reduced"/> Reduced overall costs <button aria-label="Read answer Reduced overall costs" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_9" type="radio" value="Improved"/> Improved project quality <button aria-label="Read answer Improved project quality" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
              </ol>
              <button class="check-btn" type="button" onclick="submitQuiz(this, 'bedside-week9')">Check answers</button>
              <span class="quiz-msg" id="week9-quiz-msg"></span>
            </fieldset>
          </form>
          <h4>Conclusion</h4>
          <p>By adding thoughtful design features and mastering orthogonal drawings, you ensure both functional and aesthetic excellence in your finished project.</p>
        </article>
      </details>
</main>

<!-- Popup for results -->
<div id="resultPopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <button class="close-popup" aria-label="Close">&times;</button>
    <h3>Results Submitted</h3>
    <p>You can now visit Google Classroom to record your work.</p>
    <!-- STAFF: Replace href with the project link when available -->
    <a id="popupClassroomLink" href="#" target="_blank">Open Google Classroom</a>
  </div>
</div>

<!-- Popup for entering name -->
<div id="namePopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <label for="studentName"><b>Please enter your name:</b></label><br/>
    <input type="text" id="studentName" style="margin-top:10px; padding:8px; width:95%;" />
    <button id="submitNameBtn" style="margin-top:10px;">Submit</button>
  </div>
</div>

<script>
    // Script for handling navigation link clicks and toggling active sections
    document.addEventListener('DOMContentLoaded', () => {
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.content-section');

        // Function to set the active section based on URL hash or default
        function setActiveSection() {
            let targetID = window.location.hash.substring(1) || 'program';
            if (!document.getElementById(targetID)) {
                targetID = 'program';
            }

            navLinks.forEach(nav => {
                nav.classList.remove('active');
                if (nav.getAttribute('data-section') === targetID) {
                    nav.classList.add('active');
                }
            });
            sections.forEach(sec => {
                sec.classList.remove('active');
                if (sec.id === targetID) {
                    sec.classList.add('active');
                }
            });
        }

        // Set active section on page load
        setActiveSection();

        // Add click event listeners to navigation links
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetID = link.getAttribute('data-section');
                window.location.hash = targetID;

                navLinks.forEach(nav => nav.classList.remove('active'));
                sections.forEach(sec => sec.classList.remove('active'));

                link.classList.add('active');
                const targetSection = document.getElementById(targetID);
                if (targetSection) {
                    targetSection.classList.add('active');
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Listen for hash changes (e.g., browser back/forward buttons)
        window.addEventListener('hashchange', setActiveSection);
    });
</script>
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwTomPeDrZ-vDZyEC72wXeoeFpro0Z8zCD2OfgL9HxY7nBsokoieXxy4sT3n_O4x3iqhg/exec";
const CLASSROOM_LINK = "https://classroom.google.com/w/NzQ5MDQxMzk4MjAz/t/all"; // STAFF: Replace with your Google Classroom link

// Voice setup for text-to-speech
const synth = window.speechSynthesis;
let voices = [];
synth.onvoiceschanged = () => { voices = synth.getVoices(); };

function speakText(btn) {
  let text = '';
  if (btn.dataset.text) {
    text = btn.dataset.text;
  } else {
    const p = btn.closest('p');
    if (p) {
      text = Array.from(p.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .join(' ');
    } else {
      const lbl = btn.closest('label');
      text = Array.from(lbl.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .filter(t => t.length)
        .join(' ');
    }
  }
  if (!voices.length) voices = synth.getVoices();
  const utt = new SpeechSynthesisUtterance(text);
  utt.voice = voices.find(v => v.name === 'Google UK English Female')
             || voices.find(v => /Natural/.test(v.name))
             || voices[0];
  synth.speak(utt);
}

function showResultPopup(url) {
  const overlay = document.getElementById('resultPopup');
  const link = document.getElementById('popupClassroomLink');
  if (link) link.href = url || '#';
  if (overlay) overlay.classList.add('active');
}

function askForName() {
  return new Promise(resolve => {
    const overlay = document.getElementById('namePopup');
    const input = document.getElementById('studentName');
    const btn = document.getElementById('submitNameBtn');
    if (!overlay || !input || !btn) { resolve(''); return; }
    overlay.classList.add('active');
    btn.onclick = () => {
      const name = input.value.trim();
      if (!name) return;
      overlay.classList.remove('active');
      resolve(name);
    };
  });
}

document.addEventListener('DOMContentLoaded', () => {
  const closeBtn = document.querySelector('#resultPopup .close-popup');
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      document.getElementById('resultPopup').classList.remove('active');
    });
  }
});

function submitQuiz(btn, quizType) {
  const form = btn.closest('form');
  const fieldset = form.querySelector('fieldset');
  let correct = 0, total = 0;
  const results = [];
  fieldset.querySelectorAll('li').forEach((li, idx) => {
    const radios = li.querySelectorAll('input[type=radio]');
    let userCorrect = false, answered = false;
    radios.forEach(radio => {
      if (radio.checked) {
        answered = true;
        if (radio.hasAttribute('data-correct')) userCorrect = true;
      }
      // Reset label
      radio.parentElement.removeAttribute('data-result');
    });
    total += 1;
    // Mark right/wrong visually
    radios.forEach(radio => {
      if (radio.checked) {
        radio.parentElement.setAttribute('data-result', userCorrect ? "right" : "wrong");
      }
    });
    if (userCorrect) correct += 1;
    results.push({
      question: li.querySelector('p').textContent,
      answer: Array.from(radios).find(r => r.checked)?.value || ''
    });
  });
  // Show feedback
  let msg = `You got ${correct} out of ${total} correct.`;
  form.querySelector('.quiz-msg').textContent = msg;

  askForName().then(name => {
    fetch(SCRIPT_URL, {
      method: "POST",
      mode: "cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        quizType,
        quiz: results,
        score: correct + "/" + total,
        studentName: name,
        timestamp: new Date().toISOString()
      })
    });
    showResultPopup(CLASSROOM_LINK);
  });
}

function submitAdvancedQuiz(btn, quizType) {
  const form = btn.closest('form');
  const textareas = form.querySelectorAll('textarea');
  const responses = [];
  textareas.forEach((ta) => {
    responses.push({
      question: ta.closest('li').querySelector('p').textContent,
      answer: ta.value.trim()
    });
  });

  const studentName = prompt('Please enter your name to submit your answers:');
  if (!studentName) return;

  form.querySelector('.quiz-msg').textContent =
    'Responses submitted. Your teacher will review them.';

  fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      quizType,
      studentName: studentName.trim(),
      responses,
      timestamp: new Date().toISOString()
    })
  });
  showResultPopup(CLASSROOM_LINK);
}
</script>
</body>
</html>
