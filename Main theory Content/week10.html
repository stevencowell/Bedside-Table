<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="description" content="Stage 5 Industrial Technology Timber - Bedside Table Project - 2025" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bedside Table Project</title>
  <style>
    /* General Styles */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f4f4f4;
    }
    a {
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }
    h1, h2, h3, h4, h5 {
      margin: 0 0 10px 0;
    }
    /* HEADER SECTION STYLES */
    header {
      background: #007bff;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      font-size: 2.5em;
    }
    header p {
      font-size: 1.2em;
    }
    /* NAVIGATION STYLES */
    nav {
      display: flex;
      justify-content: center;
      background: #0056b3;
      flex-wrap: wrap;
    }
    nav a {
      padding: 15px 20px;
      color: #fff;
      display: inline-block;
      transition: background 0.3s;
    }
    nav a:hover, nav a.active {
      background: #003f80;
    }
    /* GOOGLE CLASSROOM SECTION STYLES */
    .google-classroom {
      background: #fffbcc;
      padding: 20px;
      text-align: center;
      border: 1px solid #e0e0e0;
      margin: 20px auto;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      border-radius: 5px;
    }
    .google-classroom h2 {
      color: #007bff;
    }
    .google-classroom p {
      font-size: 1.1em;
    }
    .google-classroom a {
      display: inline-block;
      background: #007bff;
      color: #fff;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 5px;
      font-weight: bold;
      transition: background 0.3s;
    }
    .google-classroom a:hover {
      background: #0056b3;
    }
    /* NEW: Google Image Styles */
    .google-image {
      text-align: center;
      margin: 20px 0;
    }
    .google-image img {
      max-width: 400px;
      width: 100%;
      height: auto;
      border-radius: 5px;
    }
    /* MAIN CONTENT STYLES */
    main.content {
      padding: 20px;
    }
    .content-section {
      display: none; /* Hidden by default; activated via JS */
      background: #fff;
      margin: 10px auto;
      padding: 20px;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 5px;
    }
    .content-section.active {
      display: block;
    }
    .content-section h2 {
      color: #007bff;
      margin-bottom: 15px;
      border-bottom: 2px solid #f4f4f4;
      padding-bottom: 5px;
    }
    .content-section h3 {
      margin-top: 20px;
      color: #333;
    }
    .content-section h4 {
      margin-top: 15px;
      color: #555;
    }
    .content-section p, .content-section li {
      margin-bottom: 10px;
    }
    .content-section ul, .content-section ol {
      margin: 10px 0 15px 20px;
    }
    .content-section details {
      background: #e9ecef;
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
    }
    .content-section summary {
      cursor: pointer;
      font-size: 1.05em;
    }
    .content-section summary::-webkit-details-marker {
      color: #007bff;
    }
    .content-section details p {
      margin: 5px 0;
    }
    .resource-links ul {
      list-style: none;
      padding: 0;
    }
    .resource-links li {
      margin: 5px 0;
    }
    .resource-links a {
      color: blue;
    }
    /* Styles for quiz feedback */
    .quiz label[data-result="right"] {
        color: green;
        font-weight: bold;
    }
    .quiz label[data-result="wrong"] {
        color: red;
        text-decoration: line-through;
    }
    .quiz-msg {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    /* Style for audio buttons */
    .quiz button[aria-label^="Read"] {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1em;
        padding: 0 5px;
        vertical-align: middle;
    }

    /* Ensure all list texts are bold (except quiz lists) */
    .content-section ul li,
    .content-section ol li,
    .resource-links ul li {
      font-weight: bold;
    }
    /* Keep quiz list items normal weight */
    .quiz li {
      font-weight: normal;
    }
    .resource-links a {
      font-weight: bold;
    }



/* Ensure all summary headings (list links) are bold */
summary { font-weight: bold; }

  

  /* Make all textareas taller & wider */
  textarea { min-height: 140px; width: 95%; max-width: 900px; }
  .wide-textarea { width: 98%; max-width: 1000px; }

    /* Popup box styles */
    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .popup-overlay.active {
      display: flex;
    }
    .popup-box {
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      position: relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    .popup-box a {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border-radius: 4px;
      font-weight: bold;
    }
    .popup-box button:not(.close-popup) {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
    }
    .popup-box button:not(.close-popup):hover {
      background: #0056b3;
    }
    .popup-box button.close-popup {
      background: none;
      border: none;
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2em;
      cursor: pointer;
    }

</style>

</head>
<body>
<header>
  <h1><b>Stage 5 Industrial Technology Timber - Bedside Table Project</b> - 2025</h1>
  <p>Resources, Projects, and Content for Learning</p>
  <div class="header-image">
    <!-- STAFF: Replace 'sample_project.png' with your project image -->
      <img src="table.png" alt="Bedside Table" style="max-width:300px; width:100%; margin-top:20px; border-radius:5px;" />
    <div class="plan-link" style="margin-top:10px;">
      <!-- STAFF: Update link to your project's plan PDF -->
      <a href="BedsideTablePlan.pdf" style="background:#28a745; color:#fff; padding:10px 15px; border-radius:4px; font-weight:bold; display:inline-block;" target="_blank">Download Project Plan (PDF)</a>
    </div>
  </div>
</header>

<section class="google-classroom" aria-label="Google Classroom Invitation">
  <h2>Join Our Google Classroom</h2>
  <p>Use the code below to join the class and access all online resources:</p>
  <p><strong>Classroom Code: <span style="color:#d9534f; font-size:1.3em;">bedside23</span></strong></p>
  <!-- STAFF: Update the Google Classroom link -->
  <a href="https://classroom.google.com/w/NzQ5MDQxMzk4MjAz/t/all" target="_blank">Join Google Classroom</a>
</section>

<nav aria-label="Main Navigation">
  <a class="nav-link active" data-section="program" href="#program">Subject Program</a>
  <a class="nav-link" data-section="syllabus" href="#syllabus">Syllabus</a>
  <a class="nav-link" data-section="assessment" href="#assessment">Assessments</a>
  <a class="nav-link" data-section="project-unit" href="#project-unit">Bedside Table Project Unit</a>
  <a class="nav-link" data-section="main-theory" href="#main-theory">Main Theory Content</a>
  <a class="nav-link" data-section="support-activities" href="#support-activities">Support Theory Content (Optional)</a>
  <a class="nav-link" data-section="advanced-activities" href="#advanced-activities">Advanced Theory Content (Optional)</a>
</nav>

<main class="content">

<main class="content">
<details>
        <summary><strong>Week 10:</strong> Advanced Design Features and Orthogonal Drawings</summary>
        <article>
          <h4>Theory Content</h4>
          <p>In Week 10, you will consolidate your woodworking and design skills by focusing on advanced design features and further refining orthogonal drawings. This stage ensures your bedside table is both highly functional and aesthetically pleasing.</p>
          <h4>Advanced Design Features</h4>
          <p>Advanced design features can enhance the uniqueness and usability of your project:</p>
          <ul>
            <li>Complex inlays or intricate veneers</li>
            <li>Advanced joinery techniques such as dovetails or finger joints</li>
            <li>Customised hardware solutions like soft-close runners, decorative handles, and specialised hinges</li>
            <li>Integrated storage solutions, like compartments or concealed drawers</li>
          </ul>
          <p>Carefully select features that complement your table's overall functionality and design aesthetics.</p>
          <h4>Orthogonal Drawings</h4>
          <p>Producing detailed, accurate orthogonal drawings remains critical for guiding the final construction phase:</p>
          <ul>
            <li>Clearly show all dimensions and detailed views</li>
            <li>Include specific annotations for advanced features and joinery</li>
            <li>Ensure all hardware placements are explicitly marked</li>
          </ul>
          <h4>Practical Activity</h4>
          <ul>
            <li>Finalise and integrate selected advanced design features into your bedside table.</li>
            <li>Update and refine your orthogonal drawings with detailed annotations.</li>
          </ul>
          <h4>Resources</h4>
          <div class="resource-links">
            <ul>
              <li><a href="https://www.youtube.com/watch?v=bd5DkuzVkAs" target="_blank">Advanced Joinery Techniques (YouTube)</a></li>
              <li><a href="https://www.autodesk.com.au/solutions/cad-drawing" target="_blank">Creating Detailed CAD Drawings</a></li>
            </ul>
          </div>
          <form class="quiz" data-week="10" id="week10-quiz" style="margin-top: 1.5rem;">
            <fieldset>
              <legend><strong>Have you been paying attention? – Week 10 Quiz</strong></legend>
              <ol>
                <li>
                  <p>Why might you choose to incorporate advanced joinery techniques, like dovetails, into your project? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q1_10" type="radio" value="Quicker"/> They are quicker to assemble. <button aria-label="Read answer They are quicker to assemble." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q1_10" type="radio" value="Fewer tools"/> They require fewer tools. <button aria-label="Read answer They require fewer tools." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q1_10" type="radio" value="Enhance"/> They enhance strength and visual appeal. <button aria-label="Read answer They enhance strength and visual appeal." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q1_10" type="radio" value="Mandatory"/> They are mandatory by law. <button aria-label="Read answer They are mandatory by law." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>What is the primary benefit of detailed annotations in orthogonal drawings? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q2_10" type="radio" value="Clear instructions"/> They provide clear instructions, ensuring precision during construction. <button aria-label="Read answer They provide clear instructions, ensuring precision during construction." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q2_10" type="radio" value="Professional"/> They make drawings appear more professional. <button aria-label="Read answer They make drawings appear more professional." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q2_10" type="radio" value="No measuring"/> They reduce the need for measurements. <button aria-label="Read answer They reduce the need for measurements." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q2_10" type="radio" value="Simplify"/> They simplify the drawing process. <button aria-label="Read answer They simplify the drawing process." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>How do customised hardware solutions enhance furniture design? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q3_10" type="radio" value="Improve"/> They improve functionality and the user experience significantly. <button aria-label="Read answer They improve functionality and the user experience significantly." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q3_10" type="radio" value="Reduce complexity"/> They reduce construction complexity. <button aria-label="Read answer They reduce construction complexity." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q3_10" type="radio" value="No drawings"/> They eliminate the need for drawings. <button aria-label="Read answer They eliminate the need for drawings." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q3_10" type="radio" value="Compliance"/> They ensure compliance with regulations. <button aria-label="Read answer They ensure compliance with regulations." onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Which advanced design feature provides concealed storage and adds value to your project? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q4_10" type="radio" value="Veneers"/> Decorative veneers <button aria-label="Read answer Decorative veneers" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q4_10" type="radio" value="Hidden"/> Integrated hidden compartments <button aria-label="Read answer Integrated hidden compartments" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q4_10" type="radio" value="Routed edges"/> Routed edges <button aria-label="Read answer Routed edges" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q4_10" type="radio" value="Visible hinges"/> Visible hinges <button aria-label="Read answer Visible hinges" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>In advanced furniture design, why is it essential to ensure hardware placement is explicitly marked on orthogonal drawings? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q5_10" type="radio" value="Accurate"/> To facilitate accurate assembly and avoid costly mistakes <button aria-label="Read answer To facilitate accurate assembly and avoid costly mistakes" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_10" type="radio" value="Aesthetic"/> To increase aesthetic value <button aria-label="Read answer To increase aesthetic value" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_10" type="radio" value="Regulations"/> To satisfy workshop regulations <button aria-label="Read answer To satisfy workshop regulations" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q5_10" type="radio" value="Faster"/> To speed up drawing completion <button aria-label="Read answer To speed up drawing completion" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Why are detailed orthogonal drawings particularly important when implementing advanced joinery methods? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q6_10" type="radio" value="Required"/> They are required by the teacher <button aria-label="Read answer They are required by the teacher" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q6_10" type="radio" value="Accuracy"/> They ensure accuracy in complex joint creation and assembly <button aria-label="Read answer They ensure accuracy in complex joint creation and assembly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q6_10" type="radio" value="Heavier"/> They make the furniture heavier <button aria-label="Read answer They make the furniture heavier" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q6_10" type="radio" value="Quick"/> They help in quick project completion <button aria-label="Read answer They help in quick project completion" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Complex inlays in furniture primarily serve to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q7_10" type="radio" value="Visual"/> Enhance visual appeal and add distinctive character <button aria-label="Read answer Enhance visual appeal and add distinctive character" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q7_10" type="radio" value="Strength"/> Increase furniture strength <button aria-label="Read answer Increase furniture strength" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q7_10" type="radio" value="Simplify"/> Simplify construction <button aria-label="Read answer Simplify construction" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q7_10" type="radio" value="Reduce cost"/> Reduce material costs <button aria-label="Read answer Reduce material costs" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>The careful selection of hardware, such as soft-close runners, contributes most significantly to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q8_10" type="radio" value="Faster"/> Faster production <button aria-label="Read answer Faster production" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q8_10" type="radio" value="Function"/> Enhanced user functionality and overall product quality <button aria-label="Read answer Enhanced user functionality and overall product quality" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q8_10" type="radio" value="Reduced"/> Reduced assembly time <button aria-label="Read answer Reduced assembly time" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q8_10" type="radio" value="Compliance"/> Compliance with safety rules <button aria-label="Read answer Compliance with safety rules" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>If your orthogonal drawings omit necessary annotations, what potential problem could arise? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input name="q9_10" type="radio" value="Easy"/> Easier furniture assembly <button aria-label="Read answer Easier furniture assembly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q9_10" type="radio" value="Less waste"/> Less material wastage <button aria-label="Read answer Less material wastage" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input data-correct="true" name="q9_10" type="radio" value="Errors"/> Increased likelihood of errors during assembly <button aria-label="Read answer Increased likelihood of errors during assembly" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q9_10" type="radio" value="Durability"/> Improved furniture durability <button aria-label="Read answer Improved furniture durability" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
                <li>
                  <p>Why might incorporating advanced design features require careful planning and detailed drawings? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></p>
                  <label><input data-correct="true" name="q10_10" type="radio" value="Successful"/> To ensure successful implementation and integration of complex features <button aria-label="Read answer To ensure successful implementation and integration of complex features" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_10" type="radio" value="Complicated"/> To make the project look complicated <button aria-label="Read answer To make the project look complicated" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_10" type="radio" value="Documentation"/> To fill out project documentation <button aria-label="Read answer To fill out project documentation" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label><br/>
                  <label><input name="q10_10" type="radio" value="Avoid basics"/> To avoid using basic woodworking techniques <button aria-label="Read answer To avoid using basic woodworking techniques" onclick="event.preventDefault(); speakText(this)" type="button">🔊</button></label>
                </li>
              </ol>
              <button class="check-btn" type="button" onclick="submitQuiz(this, 'bedside-week10')">Check answers</button>
              <span class="quiz-msg" id="week10-quiz-msg"></span>
            </fieldset>
          </form>
          <h4>Conclusion</h4>
          <p>By adding advanced features and producing precise drawings, you elevate both the functionality and appearance of your bedside table.</p>
        </article>
      </details>
</main>

<!-- Popup for results -->
<div id="resultPopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <button class="close-popup" aria-label="Close">&times;</button>
    <h3>Results Submitted</h3>
    <p>You can now visit Google Classroom to record your work.</p>
    <!-- STAFF: Replace href with the project link when available -->
    <a id="popupClassroomLink" href="#" target="_blank">Open Google Classroom</a>
  </div>
</div>

<!-- Popup for entering name -->
<div id="namePopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <label for="studentName"><b>Please enter your name:</b></label><br/>
    <input type="text" id="studentName" style="margin-top:10px; padding:8px; width:95%;" />
    <button id="submitNameBtn" style="margin-top:10px;">Submit</button>
  </div>
</div>

<script>
    // Script for handling navigation link clicks and toggling active sections
    document.addEventListener('DOMContentLoaded', () => {
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.content-section');

        // Function to set the active section based on URL hash or default
        function setActiveSection() {
            let targetID = window.location.hash.substring(1) || 'program';
            if (!document.getElementById(targetID)) {
                targetID = 'program';
            }

            navLinks.forEach(nav => {
                nav.classList.remove('active');
                if (nav.getAttribute('data-section') === targetID) {
                    nav.classList.add('active');
                }
            });
            sections.forEach(sec => {
                sec.classList.remove('active');
                if (sec.id === targetID) {
                    sec.classList.add('active');
                }
            });
        }

        // Set active section on page load
        setActiveSection();

        // Add click event listeners to navigation links
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetID = link.getAttribute('data-section');
                window.location.hash = targetID;

                navLinks.forEach(nav => nav.classList.remove('active'));
                sections.forEach(sec => sec.classList.remove('active'));

                link.classList.add('active');
                const targetSection = document.getElementById(targetID);
                if (targetSection) {
                    targetSection.classList.add('active');
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Listen for hash changes (e.g., browser back/forward buttons)
        window.addEventListener('hashchange', setActiveSection);
    });
</script>
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwTomPeDrZ-vDZyEC72wXeoeFpro0Z8zCD2OfgL9HxY7nBsokoieXxy4sT3n_O4x3iqhg/exec";
const CLASSROOM_LINK = "https://classroom.google.com/w/NzQ5MDQxMzk4MjAz/t/all"; // STAFF: Replace with your Google Classroom link

// Voice setup for text-to-speech
const synth = window.speechSynthesis;
let voices = [];
synth.onvoiceschanged = () => { voices = synth.getVoices(); };

function speakText(btn) {
  let text = '';
  if (btn.dataset.text) {
    text = btn.dataset.text;
  } else {
    const p = btn.closest('p');
    if (p) {
      text = Array.from(p.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .join(' ');
    } else {
      const lbl = btn.closest('label');
      text = Array.from(lbl.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .filter(t => t.length)
        .join(' ');
    }
  }
  if (!voices.length) voices = synth.getVoices();
  const utt = new SpeechSynthesisUtterance(text);
  utt.voice = voices.find(v => v.name === 'Google UK English Female')
             || voices.find(v => /Natural/.test(v.name))
             || voices[0];
  synth.speak(utt);
}

function showResultPopup(url) {
  const overlay = document.getElementById('resultPopup');
  const link = document.getElementById('popupClassroomLink');
  if (link) link.href = url || '#';
  if (overlay) overlay.classList.add('active');
}

function askForName() {
  return new Promise(resolve => {
    const overlay = document.getElementById('namePopup');
    const input = document.getElementById('studentName');
    const btn = document.getElementById('submitNameBtn');
    if (!overlay || !input || !btn) { resolve(''); return; }
    overlay.classList.add('active');
    btn.onclick = () => {
      const name = input.value.trim();
      if (!name) return;
      overlay.classList.remove('active');
      resolve(name);
    };
  });
}

document.addEventListener('DOMContentLoaded', () => {
  const closeBtn = document.querySelector('#resultPopup .close-popup');
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      document.getElementById('resultPopup').classList.remove('active');
    });
  }
});

function submitQuiz(btn, quizType) {
  const form = btn.closest('form');
  const fieldset = form.querySelector('fieldset');
  let correct = 0, total = 0;
  const results = [];
  fieldset.querySelectorAll('li').forEach((li, idx) => {
    const radios = li.querySelectorAll('input[type=radio]');
    let userCorrect = false, answered = false;
    radios.forEach(radio => {
      if (radio.checked) {
        answered = true;
        if (radio.hasAttribute('data-correct')) userCorrect = true;
      }
      // Reset label
      radio.parentElement.removeAttribute('data-result');
    });
    total += 1;
    // Mark right/wrong visually
    radios.forEach(radio => {
      if (radio.checked) {
        radio.parentElement.setAttribute('data-result', userCorrect ? "right" : "wrong");
      }
    });
    if (userCorrect) correct += 1;
    results.push({
      question: li.querySelector('p').textContent,
      answer: Array.from(radios).find(r => r.checked)?.value || ''
    });
  });
  // Show feedback
  let msg = `You got ${correct} out of ${total} correct.`;
  form.querySelector('.quiz-msg').textContent = msg;

  askForName().then(name => {
    fetch(SCRIPT_URL, {
      method: "POST",
      mode: "cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        quizType,
        quiz: results,
        score: correct + "/" + total,
        studentName: name,
        timestamp: new Date().toISOString()
      })
    });
    showResultPopup(CLASSROOM_LINK);
  });
}

function submitAdvancedQuiz(btn, quizType) {
  const form = btn.closest('form');
  const textareas = form.querySelectorAll('textarea');
  const responses = [];
  textareas.forEach((ta) => {
    responses.push({
      question: ta.closest('li').querySelector('p').textContent,
      answer: ta.value.trim()
    });
  });

  const studentName = prompt('Please enter your name to submit your answers:');
  if (!studentName) return;

  form.querySelector('.quiz-msg').textContent =
    'Responses submitted. Your teacher will review them.';

  fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      quizType,
      studentName: studentName.trim(),
      responses,
      timestamp: new Date().toISOString()
    })
  });
  showResultPopup(CLASSROOM_LINK);
}
</script>
</body>
</html>
