<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="description" content="Stage 5 Industrial Technology Timber - Bedside Table Project - 2025" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bedside Table Project</title>
  <style>
    /* General Styles */
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background-color: #f4f4f4;
    }
    a {
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }
    h1, h2, h3, h4, h5 {
      margin: 0 0 10px 0;
    }
    /* HEADER SECTION STYLES */
    header {
      background: #007bff;
      color: #fff;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      font-size: 2.5em;
    }
    header p {
      font-size: 1.2em;
    }
    /* NAVIGATION STYLES */
    nav {
      display: flex;
      justify-content: center;
      background: #0056b3;
      flex-wrap: wrap;
    }
    nav a {
      padding: 15px 20px;
      color: #fff;
      display: inline-block;
      transition: background 0.3s;
    }
    nav a:hover, nav a.active {
      background: #003f80;
    }
    /* GOOGLE CLASSROOM SECTION STYLES */
    .google-classroom {
      background: #fffbcc;
      padding: 20px;
      text-align: center;
      border: 1px solid #e0e0e0;
      margin: 20px auto;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      border-radius: 5px;
    }
    .google-classroom h2 {
      color: #007bff;
    }
    .google-classroom p {
      font-size: 1.1em;
    }
    .google-classroom a {
      display: inline-block;
      background: #007bff;
      color: #fff;
      padding: 10px 20px;
      margin-top: 10px;
      border-radius: 5px;
      font-weight: bold;
      transition: background 0.3s;
    }
    .google-classroom a:hover {
      background: #0056b3;
    }
    /* NEW: Google Image Styles */
    .google-image {
      text-align: center;
      margin: 20px 0;
    }
    .google-image img {
      max-width: 400px;
      width: 100%;
      height: auto;
      border-radius: 5px;
    }
    /* MAIN CONTENT STYLES */
    main.content {
      padding: 20px;
    }
    .content-section {
      display: none; /* Hidden by default; activated via JS */
      background: #fff;
      margin: 10px auto;
      padding: 20px;
      width: 90%;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      border-radius: 5px;
    }
    .content-section.active {
      display: block;
    }
    .content-section h2 {
      color: #007bff;
      margin-bottom: 15px;
      border-bottom: 2px solid #f4f4f4;
      padding-bottom: 5px;
    }
    .content-section h3 {
      margin-top: 20px;
      color: #333;
    }
    .content-section h4 {
      margin-top: 15px;
      color: #555;
    }
    .content-section p, .content-section li {
      margin-bottom: 10px;
    }
    .content-section ul, .content-section ol {
      margin: 10px 0 15px 20px;
    }
    .content-section details {
      background: #e9ecef;
      margin: 10px 0;
      padding: 10px;
      border-radius: 4px;
    }
    .content-section summary {
      cursor: pointer;
      font-size: 1.05em;
    }
    .content-section summary::-webkit-details-marker {
      color: #007bff;
    }
    .content-section details p {
      margin: 5px 0;
    }
    .resource-links ul {
      list-style: none;
      padding: 0;
    }
    .resource-links li {
      margin: 5px 0;
    }
    .resource-links a {
      color: blue;
    }
    /* Styles for quiz feedback */
    .quiz label[data-result="right"] {
        color: green;
        font-weight: bold;
    }
    .quiz label[data-result="wrong"] {
        color: red;
        text-decoration: line-through;
    }
    .quiz-msg {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    /* Style for audio buttons */
    .quiz button[aria-label^="Read"] {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 1em;
        padding: 0 5px;
        vertical-align: middle;
    }

    /* Ensure all list texts are bold (except quiz lists) */
    .content-section ul li,
    .content-section ol li,
    .resource-links ul li {
      font-weight: bold;
    }
    /* Keep quiz list items normal weight */
    .quiz li {
      font-weight: normal;
    }
    .resource-links a {
      font-weight: bold;
    }



/* Ensure all summary headings (list links) are bold */
summary { font-weight: bold; }

  

  /* Make all textareas taller & wider */
  textarea { min-height: 140px; width: 95%; max-width: 900px; }
  .wide-textarea { width: 98%; max-width: 1000px; }

    /* Popup box styles */
    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .popup-overlay.active {
      display: flex;
    }
    .popup-box {
      background: #fff;
      padding: 20px;
      border-radius: 5px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      position: relative;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    .popup-box a {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border-radius: 4px;
      font-weight: bold;
    }
    .popup-box button:not(.close-popup) {
      display: inline-block;
      margin-top: 10px;
      background: #007bff;
      color: #fff;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      font-weight: bold;
      cursor: pointer;
    }
    .popup-box button:not(.close-popup):hover {
      background: #0056b3;
    }
    .popup-box button.close-popup {
      background: none;
      border: none;
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2em;
      cursor: pointer;
    }

</style>

</head>
<body>
<header>
  <h1><b>Stage 5 Industrial Technology Timber - Bedside Table Project</b> - 2025</h1>
  <p>Resources, Projects, and Content for Learning</p>
  <div class="header-image">
    <!-- STAFF: Replace 'sample_project.png' with your project image -->
      <img src="table.png" alt="Bedside Table" style="max-width:300px; width:100%; margin-top:20px; border-radius:5px;" />
    <div class="plan-link" style="margin-top:10px;">
      <!-- STAFF: Update link to your project's plan PDF -->
      <a href="BedsideTablePlan.pdf" style="background:#28a745; color:#fff; padding:10px 15px; border-radius:4px; font-weight:bold; display:inline-block;" target="_blank">Download Project Plan (PDF)</a>
    </div>
  </div>
</header>

<section class="google-classroom" aria-label="Google Classroom Invitation">
  <h2>Join Our Google Classroom</h2>
  <p>Use the code below to join the class and access all online resources:</p>
  <p><strong>Classroom Code: <span style="color:#d9534f; font-size:1.3em;">bedside23</span></strong></p>
  <!-- STAFF: Update the Google Classroom link -->
  <a href="https://classroom.google.com" target="_blank">Join Google Classroom</a>
</section>

<nav aria-label="Main Navigation">
  <a class="nav-link active" data-section="program" href="#program">Subject Program</a>
  <a class="nav-link" data-section="syllabus" href="#syllabus">Syllabus</a>
  <a class="nav-link" data-section="assessment" href="#assessment">Assessments</a>
  <a class="nav-link" data-section="project-unit" href="#project-unit">Bedside Table Project Unit</a>
  <a class="nav-link" data-section="main-theory" href="#main-theory">Main Theory Content</a>
  <a class="nav-link" data-section="support-activities" href="#support-activities">Support Theory Content (Optional)</a>
  <a class="nav-link" data-section="advanced-activities" href="#advanced-activities">Advanced Theory Content (Optional)</a>
</nav>

<main class="content">

<main class="content">
<details>
  <summary><strong>Week 19:</strong> Catch-Up, Final Adjustments, and Workshop Maintenance</summary>
  <article>
    <h4>Theory Content</h4>
    <p>Week 19 provides an opportunity to finalise any unfinished project components, address any remaining issues, and ensure the workshop space is properly maintained. Effective project closure and workshop maintenance are critical for a safe, organised, and productive woodworking environment.</p>
    <h4>Final Project Adjustments</h4>
    <p>Ensure all components are correctly finished:</p>
    <ul>
      <li>Check all joinery and ensure stability.</li>
      <li>Inspect finishing quality and make minor corrections if necessary.</li>
      <li>Verify hardware installations and functionality.</li>
    </ul>
    <h4>Project Documentation Completion</h4>
    <p>Finalise all documentation, ensuring it is comprehensive and professionally presented:</p>
    <ul>
      <li>Review portfolio completeness, including drawings, reflections, and evaluations.</li>
      <li>Confirm all project costs and materials are documented accurately.</li>
    </ul>
    <h4>Workshop Maintenance</h4>
    <p>Maintaining a clean, organised workshop is essential for safety and efficiency:</p>
    <ul>
      <li>Clean and store all tools and machinery properly.</li>
      <li>Inspect equipment for wear or damage, reporting any issues immediately.</li>
      <li>Organise leftover materials and correctly dispose of waste.</li>
      <li>Ensure chemical storage areas are secure and properly labelled.</li>
    </ul>
    <h4>Practical Activity</h4>
    <ul>
      <li>Complete any unfinished tasks on your bedside table project.</li>
      <li>Conduct thorough workshop cleaning and maintenance activities.</li>
      <li>Finalise and submit your project documentation.</li>
    </ul>
    <h4>Resources</h4>
    <div class="resource-links">
      <ul>
        <li><a href="https://www.youtube.com/watch?v=dh8S4v2hGFI" target="_blank">Workshop Organisation and Maintenance (YouTube)</a></li>
        <li><a href="https://www.familyhandyman.com/project/workshop-organization-ideas/" target="_blank">Efficient Workshop Practices</a></li>
      </ul>
    </div>
    <form class="quiz" data-week="19" id="week19-quiz" style="margin-top: 1.5rem;">
      <fieldset>
        <legend><strong>Have you been paying attention? â€“ Week 19 Quiz</strong></legend>
        <ol>
          <li>
            <p>Why is it important to thoroughly inspect hardware installations before project completion? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label><input name="q1_19" type="radio" value="Costs"/> To reduce costs <button aria-label="Read answer To reduce costs" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label data-correct="true"><input name="q1_19" type="radio" value="Functionality"/> To ensure functionality and durability <button aria-label="Read answer To ensure functionality and durability" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q1_19" type="radio" value="Speed"/> To speed up final assembly <button aria-label="Read answer To speed up final assembly" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q1_19" type="radio" value="Aesthetics"/> To comply with aesthetic guidelines <button aria-label="Read answer To comply with aesthetic guidelines" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Final project documentation must be comprehensive because: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label><input name="q2_19" type="radio" value="Future"/> It speeds up future projects <button aria-label="Read answer It speeds up future projects" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label data-correct="true"><input name="q2_19" type="radio" value="Communicate"/> It effectively communicates your project's scope, process, and quality <button aria-label="Read answer It effectively communicates your project's scope, process, and quality" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q2_19" type="radio" value="Teacher"/> It is only required by the teacher <button aria-label="Read answer It is only required by the teacher" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q2_19" type="radio" value="Inspection"/> It eliminates the need for physical inspections <button aria-label="Read answer It eliminates the need for physical inspections" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Proper workshop maintenance primarily ensures: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label data-correct="true"><input name="q3_19" type="radio" value="Safety"/> Safety, efficiency, and longevity of tools and equipment <button aria-label="Read answer Safety, efficiency, and longevity of tools and equipment" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q3_19" type="radio" value="Timber"/> Increased timber supply <button aria-label="Read answer Increased timber supply" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q3_19" type="radio" value="PPE"/> Reduced PPE usage <button aria-label="Read answer Reduced PPE usage" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q3_19" type="radio" value="Speed"/> Faster project completion <button aria-label="Read answer Faster project completion" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>When identifying minor finishing issues late in the project, what is the best course of action? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label><input name="q4_19" type="radio" value="Ignore"/> Ignore minor issues <button aria-label="Read answer Ignore minor issues" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label data-correct="true"><input name="q4_19" type="radio" value="Correct"/> Correct them carefully to ensure a professional-quality finish <button aria-label="Read answer Correct them carefully to ensure a professional-quality finish" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q4_19" type="radio" value="Restart"/> Start the project over <button aria-label="Read answer Start the project over" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q4_19" type="radio" value="Increase"/> Increase finishing materials used <button aria-label="Read answer Increase finishing materials used" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Effective disposal of workshop waste is essential to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label data-correct="true"><input name="q5_19" type="radio" value="Safety"/> Maintain safety and environmental responsibility <button aria-label="Read answer Maintain safety and environmental responsibility" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q5_19" type="radio" value="Projects"/> Increase the number of projects <button aria-label="Read answer Increase the number of projects" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q5_19" type="radio" value="Docs"/> Reduce project documentation <button aria-label="Read answer Reduce project documentation" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q5_19" type="radio" value="Appearance"/> Improve workshop appearance only <button aria-label="Read answer Improve workshop appearance only" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Why must you promptly report any identified equipment wear or damage? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label data-correct="true"><input name="q6_19" type="radio" value="Repairs"/> To ensure immediate repairs and maintain safety <button aria-label="Read answer To ensure immediate repairs and maintain safety" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q6_19" type="radio" value="Slow"/> To slow down project completion <button aria-label="Read answer To slow down project completion" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q6_19" type="radio" value="Costs"/> To increase workshop costs <button aria-label="Read answer To increase workshop costs" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q6_19" type="radio" value="Regulations"/> To comply with regulations only <button aria-label="Read answer To comply with regulations only" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Organising leftover materials effectively contributes to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label data-correct="true"><input name="q7_19" type="radio" value="Planning"/> Efficient future project planning and reduced waste <button aria-label="Read answer Efficient future project planning and reduced waste" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q7_19" type="radio" value="Costs"/> Increased material costs <button aria-label="Read answer Increased material costs" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q7_19" type="radio" value="Timeline"/> Longer project timelines <button aria-label="Read answer Longer project timelines" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q7_19" type="radio" value="Docs"/> Less need for documentation <button aria-label="Read answer Less need for documentation" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Chemical storage areas in the workshop must be secure and labelled clearly to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label><input name="q8_19" type="radio" value="Space"/> Reduce storage space <button aria-label="Read answer Reduce storage space" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label data-correct="true"><input name="q8_19" type="radio" value="Safety"/> Prevent misuse and ensure safety <button aria-label="Read answer Prevent misuse and ensure safety" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q8_19" type="radio" value="Cleaning"/> Simplify workshop cleaning <button aria-label="Read answer Simplify workshop cleaning" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q8_19" type="radio" value="Availability"/> Increase chemical availability <button aria-label="Read answer Increase chemical availability" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>What is the main benefit of completing all final project documentation accurately? <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label data-correct="true"><input name="q9_19" type="radio" value="Record"/> It provides a detailed record for future reference and assessment <button aria-label="Read answer It provides a detailed record for future reference and assessment" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q9_19" type="radio" value="Reduce"/> It reduces future woodworking tasks <button aria-label="Read answer It reduces future woodworking tasks" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q9_19" type="radio" value="Maintenance"/> It speeds up tool maintenance <button aria-label="Read answer It speeds up tool maintenance" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q9_19" type="radio" value="Cleaning"/> It decreases workshop cleaning needs <button aria-label="Read answer It decreases workshop cleaning needs" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
          <li>
            <p>Regular workshop cleaning and maintenance routines primarily help to: <button aria-label="Read question aloud" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></p>
            <label><input name="q10_19" type="radio" value="Complexity"/> Increase project complexity <button aria-label="Read answer Increase project complexity" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label data-correct="true"><input name="q10_19" type="radio" value="Safety"/> Maintain safety, productivity, and equipment functionality <button aria-label="Read answer Maintain safety, productivity, and equipment functionality" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q10_19" type="radio" value="Short"/> Shorten class durations <button aria-label="Read answer Shorten class durations" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label><br/>
            <label><input name="q10_19" type="radio" value="Docs"/> Reduce documentation requirements <button aria-label="Read answer Reduce documentation requirements" onclick="event.preventDefault(); speakText(this)" type="button">ðŸ”Š</button></label>
          </li>
        </ol>
        <button class="check-btn" type="button" onclick="submitQuiz(this, 'bedside-week19')">Check answers</button>
        <span class="quiz-msg" id="week19-quiz-msg"></span>
      </fieldset>
    </form>
    <h4>Conclusion</h4>
    <p>Thorough project completion and maintenance keep the workshop safe and organised.</p>
  </article>
</details>
</main>

<!-- Popup for results -->
<div id="resultPopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <button class="close-popup" aria-label="Close">&times;</button>
    <h3>Results Submitted</h3>
    <p>You can now visit Google Classroom to record your work.</p>
    <!-- STAFF: Replace href with the project link when available -->
    <a id="popupClassroomLink" href="#" target="_blank">Open Google Classroom</a>
  </div>
</div>

<!-- Popup for entering name -->
<div id="namePopup" class="popup-overlay" role="dialog" aria-modal="true">
  <div class="popup-box">
    <label for="studentName"><b>Please enter your name:</b></label><br/>
    <input type="text" id="studentName" style="margin-top:10px; padding:8px; width:95%;" />
    <button id="submitNameBtn" style="margin-top:10px;">Submit</button>
  </div>
</div>

<script>
    // Script for handling navigation link clicks and toggling active sections
    document.addEventListener('DOMContentLoaded', () => {
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.content-section');

        // Function to set the active section based on URL hash or default
        function setActiveSection() {
            let targetID = window.location.hash.substring(1) || 'program';
            if (!document.getElementById(targetID)) {
                targetID = 'program';
            }

            navLinks.forEach(nav => {
                nav.classList.remove('active');
                if (nav.getAttribute('data-section') === targetID) {
                    nav.classList.add('active');
                }
            });
            sections.forEach(sec => {
                sec.classList.remove('active');
                if (sec.id === targetID) {
                    sec.classList.add('active');
                }
            });
        }

        // Set active section on page load
        setActiveSection();

        // Add click event listeners to navigation links
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetID = link.getAttribute('data-section');
                window.location.hash = targetID;

                navLinks.forEach(nav => nav.classList.remove('active'));
                sections.forEach(sec => sec.classList.remove('active'));

                link.classList.add('active');
                const targetSection = document.getElementById(targetID);
                if (targetSection) {
                    targetSection.classList.add('active');
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Listen for hash changes (e.g., browser back/forward buttons)
        window.addEventListener('hashchange', setActiveSection);
    });
</script>
<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwTomPeDrZ-vDZyEC72wXeoeFpro0Z8zCD2OfgL9HxY7nBsokoieXxy4sT3n_O4x3iqhg/exec";
const CLASSROOM_LINK = "#"; // STAFF: Replace with your Google Classroom link

// Voice setup for text-to-speech
const synth = window.speechSynthesis;
let voices = [];
synth.onvoiceschanged = () => { voices = synth.getVoices(); };

function speakText(btn) {
  let text = '';
  if (btn.dataset.text) {
    text = btn.dataset.text;
  } else {
    const p = btn.closest('p');
    if (p) {
      text = Array.from(p.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .join(' ');
    } else {
      const lbl = btn.closest('label');
      text = Array.from(lbl.childNodes)
        .filter(n => n.nodeType === Node.TEXT_NODE)
        .map(n => n.textContent.trim())
        .filter(t => t.length)
        .join(' ');
    }
  }
  if (!voices.length) voices = synth.getVoices();
  const utt = new SpeechSynthesisUtterance(text);
  utt.voice = voices.find(v => v.name === 'Google UK English Female')
             || voices.find(v => /Natural/.test(v.name))
             || voices[0];
  synth.speak(utt);
}

function showResultPopup(url) {
  const overlay = document.getElementById('resultPopup');
  const link = document.getElementById('popupClassroomLink');
  if (link) link.href = url || '#';
  if (overlay) overlay.classList.add('active');
}

function askForName() {
  return new Promise(resolve => {
    const overlay = document.getElementById('namePopup');
    const input = document.getElementById('studentName');
    const btn = document.getElementById('submitNameBtn');
    if (!overlay || !input || !btn) { resolve(''); return; }
    overlay.classList.add('active');
    btn.onclick = () => {
      const name = input.value.trim();
      if (!name) return;
      overlay.classList.remove('active');
      resolve(name);
    };
  });
}

document.addEventListener('DOMContentLoaded', () => {
  const closeBtn = document.querySelector('#resultPopup .close-popup');
  if (closeBtn) {
    closeBtn.addEventListener('click', () => {
      document.getElementById('resultPopup').classList.remove('active');
    });
  }
});

function submitQuiz(btn, quizType) {
  const form = btn.closest('form');
  const fieldset = form.querySelector('fieldset');
  let correct = 0, total = 0;
  const results = [];
  fieldset.querySelectorAll('li').forEach((li, idx) => {
    const radios = li.querySelectorAll('input[type=radio]');
    let userCorrect = false, answered = false;
    radios.forEach(radio => {
      if (radio.checked) {
        answered = true;
        if (radio.hasAttribute('data-correct')) userCorrect = true;
      }
      // Reset label
      radio.parentElement.removeAttribute('data-result');
    });
    total += 1;
    // Mark right/wrong visually
    radios.forEach(radio => {
      if (radio.checked) {
        radio.parentElement.setAttribute('data-result', userCorrect ? "right" : "wrong");
      }
    });
    if (userCorrect) correct += 1;
    results.push({
      question: li.querySelector('p').textContent,
      answer: Array.from(radios).find(r => r.checked)?.value || ''
    });
  });
  // Show feedback
  let msg = `You got ${correct} out of ${total} correct.`;
  form.querySelector('.quiz-msg').textContent = msg;

  askForName().then(name => {
    fetch(SCRIPT_URL, {
      method: "POST",
      mode: "cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        quizType,
        quiz: results,
        score: correct + "/" + total,
        studentName: name,
        timestamp: new Date().toISOString()
      })
    });
    showResultPopup(CLASSROOM_LINK);
  });
}

function submitAdvancedQuiz(btn, quizType) {
  const form = btn.closest('form');
  const textareas = form.querySelectorAll('textarea');
  const responses = [];
  textareas.forEach((ta) => {
    responses.push({
      question: ta.closest('li').querySelector('p').textContent,
      answer: ta.value.trim()
    });
  });

  const studentName = prompt('Please enter your name to submit your answers:');
  if (!studentName) return;

  form.querySelector('.quiz-msg').textContent =
    'Responses submitted. Your teacher will review them.';

  fetch(SCRIPT_URL, {
    method: 'POST',
    mode: 'cors',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      quizType,
      studentName: studentName.trim(),
      responses,
      timestamp: new Date().toISOString()
    })
  });
  showResultPopup(CLASSROOM_LINK);
}
</script>
</body>
</html>
